---
title: "Sesi√≥n 9: Correlaci√≥n y Regresi√≥n Simple"
format: html
filters:
  - webr
---

# Caso: Salarios y A√±os de Escolaridad

¬øCu√°nto vale un a√±o adicional de educaci√≥n en el mercado laboral?

```{webr-r}
set.seed(2026)
n <- 150

# Simular a√±os de escolaridad (6-20 a√±os)
escolaridad <- runif(n, 6, 20)

# Salario = 500 + 150*escolaridad + ruido
# Interpretaci√≥n: cada a√±o extra vale $150/mes
salario <- 500 + (150 * escolaridad) + rnorm(n, 0, 400)

datos <- data.frame(escolaridad, salario)

# Scatterplot
plot(escolaridad, salario, pch=19, col=rgb(0,0,0,0.5),
     main="Relaci√≥n Escolaridad-Salario",
     xlab="A√±os de Escolaridad", ylab="Salario Mensual ($)")

# Regresi√≥n lineal
modelo <- lm(salario ~ escolaridad)
abline(modelo, col="blue", lwd=3)

summary(modelo)

cat("\nüí∞ INTERPRETACI√ìN\n")
cat("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n")
cat("Intercepto:  $", round(coef(modelo)[1], 2), "\n")
cat("  ‚Üí Salario base (0 a√±os de escuela, extrapolaci√≥n)\n\n")

cat("Pendiente:   $", round(coef(modelo)[2], 2), "/a√±o\n")
cat("  ‚Üí Cada a√±o adicional se asocia con $", 
    round(coef(modelo)[2], 2), " m√°s de salario\n\n")

cat("R¬≤:          ", round(summary(modelo)$r.squared, 3), "\n")
cat("  ‚Üí La escolaridad explica el ", 
    round(100*summary(modelo)$r.squared, 1), "% de variaci√≥n en salarios\n\n")

cat("‚ö†Ô∏è  Esto es ASOCIACI√ìN, no CAUSALIDAD\n")
cat("   Pueden existir variables omitidas (habilidad, conexiones, etc.)\n")
```

---

# Parte 1: Residuos y Diagn√≥stico

```{webr-r}
# Plot de residuos
par(mfrow=c(2,2))
plot(modelo)
par(mfrow=c(1,1))

# Residuos vs valores ajustados
plot(modelo$fitted.values, modelo$residuals,
     pch=19, col=rgb(0,0,0,0.5),
     main="Residuos vs Valores Ajustados",
     xlab="Salario Predicho", ylab="Residuos")
abline(h=0, col="red", lty=2, lwd=2)

cat("\nüìä AN√ÅLISIS DE RESIDUOS\n")
cat("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n")
cat("Media de residuos:    ", round(mean(modelo$residuals), 6), "\n")
cat("DE de residuos:       $", round(sd(modelo$residuals), 2), "\n")
cat("M√°ximo residuo:       $", round(max(abs(modelo$residuals)), 2), "\n\n")

cat("‚úÖ Si residuos est√°n distribuidos aleatoriamente ‚Üí modelo OK\n")
cat("‚ùå Si hay patr√≥n (curva, embudo) ‚Üí modelo inadecuado\n")
```

---

# Parte 2: Predicci√≥n e Intervalo

```{webr-r}
# Predecir salario para 16 a√±os de educaci√≥n
nuevo_dato <- data.frame(escolaridad = 16)
prediccion <- predict(modelo, nuevo_dato, interval="confidence", level=0.95)

cat("\nüéØ PREDICCI√ìN\n")
cat("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n")
cat("Para alguien con 16 a√±os de educaci√≥n:\n")
cat("  Salario esperado:  $", round(prediccion[1], 2), "\n")
cat("  IC 95%:            [$", round(prediccion[2], 2), ", $", 
    round(prediccion[3], 2), "]\n\n")
```

---

# Ejercicio Individual

1. **Grafica** relaci√≥n con ejes transformados (log-log)
2. **Calcula** R¬≤ si excluyes outliers
3. **Compara** pendientes por g√©nero (si tuvieras esa variable)

---

# Discusi√≥n

- ¬øCorrelaci√≥n = causalidad?
- ¬øQu√© variables omitidas podr√≠an sesgar la pendiente?
- ¬øC√≥mo interpretar√≠as R¬≤=0.3 vs R¬≤=0.9?

